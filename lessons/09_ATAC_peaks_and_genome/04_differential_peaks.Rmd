---
title: "04_differential_peaks"
author: "JR"
date: "2024-11-28"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(GenomicRanges)
source("../../util/00_our_first_function_lesson.R")
```

# Goal: To find ATACseq peaks that change upon exposure to dox.
First we will attempt a simple overlap of 0 time point (no dox)
to the rest of the time points. This will tell us which peaks existed 
at time 0 and dissapeared and those that didn't exist at time 0 and appeared!


# Loading environment from 03: peak/overlap objects, genome_feature objects
```{r loading objects from 03_peaks_to_genome_feature.rmd}

# Loading our prior work !
load("results/key_mouse_atac_data.Rdata")

# Nice - good to go !
```

# Find peaks that are common to 0 time points
```{r}

# Setting object to 0 time point
non_dox_samples <- my_peaks[c("KO_control_0", "WT_control_0")]

# find common peaks
non_dox_common_peaks <- find_common_peaks(non_dox_samples)
length(non_dox_common_peaks)
# random file test
length(my_peaks$KO_control_0)

# Nice we have the overlaps of our non-dox, let's do the same for dox !
# first grep out non 0 time point names
dox_samples <- names(my_peaks)[!grepl("_0$", names(my_peaks))]

# Now indexing to make a list of GRanges of non-0 (no dox) time points
dox_peaks <- my_peaks[dox_samples]

# finding common overlaps
dox_common_peaks <- find_common_peaks(dox_peaks)
length(dox_common_peaks)
# random single example
length(my_peaks$KO_control_30)

# Nice we are now set to compare non-dox vs dox !
```

